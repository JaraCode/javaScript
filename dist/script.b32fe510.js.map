{"version":3,"sources":["assets/mediaPlayer.js","assets/plugins/autoPlay.js","assets/plugins/autoPause.js","assets/script.js"],"names":["MediaPlayer","config","media","el","plugins","_initPlugins","prototype","player","play","pause","muted","value","forEach","plugin","run","mute","unmute","toggleMute","AutoPlay","AutoPause","constructor","threshold","handleInterseption","bind","handleVisibilityChange","pausedByScroll","pausedByTab","observer","IntersectionObserver","observe","document","addEventListener","entries","entry","isIntersecting","paused","isVisible","visibilityState","video","querySelector","playButton","muteButton","onclick","navigator","serviceWorker","register","catch","err","console","log","message"],"mappings":";;AGAA;;AACA;;AACA;AHFA,AEAA,ADAA,MCAMmB,GFAGnB,ACAAkB,MCAT,CAAgB,CDAhB,GDAA,ACAoB,CDACjB,ACEpB,MDFD,EAA6B;AACzB,AEAAmB,EAAAA,KFAKlB,KAAL,CEAW,EFAED,CEAC,KFAK,CAACE,EAApB;AACA,AEAI,ADCRe,ODDSd,CCCD,CCDKiB,ADCJf,KDDL,GAAeL,CEAX,ADCR,CAAmBa,ECDM,CDCzB,CDDyB,CAACV,CEAlB,ADCiB,MDDN,IAAkB,ACCHG,EDD9B,ICCqB,EAAiB;ACAlC,ADCJ,AEAJ,MFAQ,AEAF+B,CFAG/B,ECDIe,ECCF,EFAI,CAACZ,AEAFoB,KFAV,EAAmB,CEAD,CAACS,IDDf,GAA0B,KAAKjB,CCCzB,CAAuB,OAAvB,CAAd,QDDkC,CAAwBC,IAAxB,CAA6B,IAA7B,CAA1B;AFCJ,AEAI,ADCAhB,AEAR,IFAQA,EEAFiC,CHDGnC,EEAImB,CDCC,CAACd,KAAP,AEAQ,GHDZ,ACCmB,AEAJoB,IFAX,IEAmB,CAACS,GDDpB,GAA8B,KAAKf,ECCxB,CAAuB,iBAAvB,CAAnB,CDDsC,CAA4BD,IAA5B,CAAiC,IAAjC,CAA9B;AFCP,AEAI,ADCA,AEAL,MAAMkB,UAAU,GAAGX,QAAQ,CAACS,aAAT,CAAuB,iBAAvB,CAAnB;AAEA,MAAMhC,MAAM,GAAG,IAAIP,oBAAJ,CAAgB;AHD/BA,AEAIc,ADAAP,AEEAJ,EDFAW,ADAAP,AEEAJ,EAAE,CDFC,CAACI,ACEA+B,EFFE,CAAC9B,EDAA,AGCoB,CHDnBF,AEAL,CDAH,CCAY,OFAhB,CAAsBD,YAAtB,GAAqC,YAAW;AAC5C,AEAI,ADAP,AEEGD,CFPJ,CEOIA,MHFMG,CEAGA,ACEF,EAAE,CAAE,EHFC,CEAR,CCEWW,CHFA,CEAGX,MAAd,SCEO,EAAF,EAAkB,IAAIY,kBAAJ,EAAlB;AHDLX,AEAA,ACDuB,CAAhB,CAAf,EHCQA,IAAI,CEACiB,CFAC,MAAM,KAAKjB,EEAjB,EFAY,CEAU,CFDX,IECX;AFCAC,AEAA,ACGR,IHHQA,KAAK,AEAAiB,EFAE,ICDAR,EDCM,GEAb,EFAkBT,CEAC,IFAN,C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","file":"script.b32fe510.js","sourceRoot":"..","sourcesContent":["function MediaPlayer(config) {\r\n    this.media = config.el;\r\n    this.plugins = config.plugins || [];\r\n    \r\n    this._initPlugins();\r\n}\r\n\r\nMediaPlayer.prototype._initPlugins = function() {\r\n    const player = {\r\n        play: () => this.play(),\r\n        pause: () => this.pause(),\r\n        media: this.media,\r\n        get muted() {\r\n            return this.media.muted;\r\n        },\r\n        set muted(value) {\r\n            this.media.muted = value;\r\n            /*\r\n            if (value === true) {\r\n                this.media.muted = true;\r\n            } else {\r\n                this.media.muted = false;\r\n            }\r\n            */\r\n        }\r\n    };\r\n    this.plugins.forEach(plugin => {\r\n        plugin.run(player);\r\n    });\r\n}\r\n\r\nMediaPlayer.prototype.play = function() {\r\n    this.media.play();\r\n};\r\n\r\nMediaPlayer.prototype.pause = function() {\r\n    this.media.pause();\r\n};\r\n\r\nMediaPlayer.prototype.mute = function() {\r\n    this.media.muted = true;\r\n};\r\n\r\nMediaPlayer.prototype.unmute = function() {\r\n    this.media.muted = false;\r\n};\r\n\r\nMediaPlayer.prototype.toggleMute = function toggleMute() {\r\n    this.media.muted = !this.media.muted\r\n};\r\n\r\nexport default MediaPlayer;\r\n  \r\n/*\r\nMediaPlayer.prototype.togglePlay = function() {\r\n    if (this.media.paused) {\r\n        this.play();\r\n    } else {\r\n        this.pause();\r\n    }\r\n};\r\n*/","function AutoPlay() {\r\n\r\n}\r\nAutoPlay.prototype.run = function(player) {\r\n    if (!player.muted) {\r\n        player.muted = true;\r\n    }    \r\n    player.play();\r\n}\r\nexport default AutoPlay;","class AutoPause {\r\n    constructor() {\r\n        this.threshold = 0.25;        \r\n        this.handleInterseption = this.handleInterseption.bind(this);\r\n        this.handleVisibilityChange = this.handleVisibilityChange.bind(this);\r\n    }\r\n\r\n    run(player) {\r\n        this.player = player;\r\n        this.pausedByScroll = false;\r\n        this.pausedByTab = false;\r\n        // const observer = new IntersectionObserver(handler, config)\r\n        const observer = new IntersectionObserver(\r\n            // threshold: umbral - define que % del elemento tiene que tener interseccion\r\n            this.handleInterseption, { threshold: this.threshold }\r\n        );\r\n        observer.observe(this.player.media);\r\n\r\n        document.addEventListener(\"visibilitychange\", this.handleVisibilityChange)\r\n    }\r\n\r\n    handleInterseption(entries) {\r\n        const entry = entries[0];\r\n        if ( !entry.isIntersecting && !this.player.media.paused ) {\r\n            this.player.pause();  \r\n            this.pausedByScroll = true;\r\n        }\r\n        if ( entry.isIntersecting && this.pausedByScroll ) {\r\n            this.player.play();\r\n            this.pausedByScroll = false;\r\n        }         \r\n    }\r\n\r\n    handleVisibilityChange() {\r\n        const isVisible = document.visibilityState === \"visible\";\r\n\r\n        if ( !isVisible && !this.player.media.paused ) {\r\n            this.player.pause();  \r\n            this.pausedByTab = true;\r\n        }\r\n        if ( isVisible && this.pausedByTab ) {\r\n            this.player.play();\r\n            this.pausedByTab = false;\r\n        }\r\n    }\r\n}\r\nexport default AutoPause;","import MediaPlayer from './mediaPlayer.js';\r\nimport AutoPlay from './plugins/autoPlay.js';\r\nimport AutoPause from './plugins/autoPause.js'\r\n\r\nconst video = document.querySelector('video');\r\nconst playButton = document.querySelector('#btn-video-play');\r\nconst muteButton = document.querySelector('#btn-video-mute');\r\n\r\nconst player = new MediaPlayer({ \r\n    el: video, \r\n    plugins: [ new AutoPlay(), new AutoPause() ] \r\n});\r\n\r\n/*\r\n// Funciona, pero no es muy extensible\r\nplayButton.onclick = () => video.play();\r\n// Por eso desarrollamos una clase (obj en js) MediaPlayer\r\n\r\nplayButton.onclick = () => player.togglePlay();\r\n*/\r\n\r\nplayButton.onclick = () => {\r\n    player.media.paused? player.play() : player.pause()\r\n}\r\n\r\nmuteButton.onclick = () => player.toggleMute();\r\n\r\nif ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.register('/sw.js').catch( err => {\r\n        console.log(err.message);\r\n    });\r\n}"]}